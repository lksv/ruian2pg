# Common variables for all hosts

# Application settings
app_user: lukas
app_home: "/home/{{ app_user }}"
app_dir: "{{ app_home }}/ruian2pg"
data_dir: "{{ app_dir }}/data"
uv_bin: /usr/local/bin/uv

# Git repository
git_repo: "https://github.com/lksv/ruian2pg.git"
git_branch: master

# Database settings
db_name: ruian
db_user: ruian
db_password: "{{ vault_db_password }}"  # Mapped from vault.yml

# Docker settings
docker_network: ruian-network
postgres_container: ruian-postgis
postgres_image: postgis/postgis:18-3.6
postgres_volume: ruian_pgdata

# Set to true to preserve existing database container (won't recreate if exists)
# This protects existing RUIAN data from being lost
preserve_existing_database: true

martin_container: martin
martin_image: ghcr.io/maplibre/martin
martin_port: 3000

# Nginx settings
nginx_root: "{{ app_dir }}/web"
tile_cache_size: 2g  # Nginx disk cache for tiles

# Domain settings
domain_name: "{{ vault_domain_name }}"

# SSL/TLS settings
ssl_enabled: true
ssl_domain: "{{ domain_name }}"

# Certbot settings
certbot_email: "{{ vault_certbot_email }}"
certbot_webroot: /var/www/certbot

# eDesky API
edesky_api_key: "{{ vault_edesky_api_key }}"

# SSL paths (derived from ssl_domain)
ssl_certificate: "/etc/letsencrypt/live/{{ ssl_domain }}/fullchain.pem"
ssl_certificate_key: "/etc/letsencrypt/live/{{ ssl_domain }}/privkey.pem"

# Timezone and locale
timezone: Europe/Prague
locale: cs_CZ.UTF-8

# System packages
common_packages:
  # Basic utilities
  - curl
  - wget
  - gnupg
  - ca-certificates
  - apt-transport-https
  # Editors
  - vim
  - neovim
  # Version control
  - git
  # Python
  - python3
  - python3-pip
  - python3-venv
  # RUIAN dependencies
  - gdal-bin
  - postgresql-client
  # OCR / text extraction (for tesserocr)
  - tesseract-ocr
  - tesseract-ocr-ces
  - libtesseract-dev
  - libleptonica-dev
  # Utilities
  - htop
  - tmux
  - tree
  - jq
  - unzip
  - rsync
  # Security updates
  - unattended-upgrades
  - apt-listchanges
