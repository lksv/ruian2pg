# Martin Tile Server Configuration for RUIAN Data
# See: https://maplibre.org/martin/

# Server settings
listen_addresses: '0.0.0.0:3000'

# PostgreSQL connection
postgres:
  # For local development (Podman/Docker)
  # Use host.containers.internal to connect from container to host
  connection_string: 'postgresql://ruian:ruian@host.containers.internal:5432/ruian'

  # Default SRID for all tables (S-JTSK / Krovak East North)
  default_srid: 5514

  # Disable auto-publish to avoid conflicts with explicit table definitions
  auto_publish:
    tables: false
    functions: false

  # Table configurations with specific geometry columns
  tables:
    # Address points - main geometry
    adresnimista:
      schema: public
      table: adresnimista
      srid: 5514
      geometry_column: geom
      id_column: ogc_fid
      properties:
        kod: int4
        cislodomovni: int4
        cisloorientacni: int4
        cisloorientacnipismeno: varchar
        psc: int4
        ulicekod: int4

    # Buildings - polygon boundaries
    stavebniobjekty:
      schema: public
      table: stavebniobjekty
      srid: 5514
      geometry_column: originalnihranice
      id_column: ogc_fid
      properties:
        kod: int4
        cislodomovni: _int4
        typstavebnihoobjektukod: int4
        zpusobvyuzitikod: int4
        pocetpodlazi: int4
        pocetbytu: int4
        zastavenaplocha: int4

    # Parcels - polygon boundaries
    parcely:
      schema: public
      table: parcely
      srid: 5514
      geometry_column: originalnihranice
      id_column: ogc_fid
      properties:
        id: int8
        kmenovecislo: int4
        pododdelenicisla: int4
        vymeraparcely: int8
        druhpozemkukod: int4

    # Streets - line geometry
    ulice:
      schema: public
      table: ulice
      srid: 5514
      geometry_column: geom
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        obeckod: int4

    # Municipalities - polygon boundaries
    obce:
      schema: public
      table: obce
      srid: 5514
      geometry_column: originalnihranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        statuskod: int4
        okreskod: int4

    # Municipality parts
    castiobci:
      schema: public
      table: castiobci
      srid: 5514
      geometry_column: geom
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        obeckod: int4

    # Cadastral areas
    katastralniuzemi:
      schema: public
      table: katastralniuzemi
      srid: 5514
      geometry_column: originalnihranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        obeckod: int4

    # Basic settlement units (ZSJ)
    zsj:
      schema: public
      table: zsj
      srid: 5514
      geometry_column: originalnihranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        katastralniuzemikod: int4

    # Districts
    okresy:
      schema: public
      table: okresy
      srid: 5514
      geometry_column: generalizovanehranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        krajkod: int4
        vusckod: int4
        nutslau: varchar

    # Regions (kraje)
    kraje:
      schema: public
      table: kraje
      srid: 5514
      geometry_column: generalizovanehranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        statkod: int4
        nutslau: varchar

    # Higher self-governing regions (VUSC)
    vusc:
      schema: public
      table: vusc
      srid: 5514
      geometry_column: generalizovanehranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        regionsoudrznostikod: int4
        nutslau: varchar

    # ORP (municipalities with extended powers)
    orp:
      schema: public
      table: orp
      srid: 5514
      geometry_column: generalizovanehranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        vusckod: int4
        spravniobeckod: int4

    # POU (municipalities with authorized office)
    pou:
      schema: public
      table: pou
      srid: 5514
      geometry_column: generalizovanehranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        orpkod: int4

    # Cohesion regions
    regionysoudrznosti:
      schema: public
      table: regionysoudrznosti
      srid: 5514
      geometry_column: generalizovanehranice
      id_column: ogc_fid
      properties:
        kod: int4
        nazev: varchar
        nutslau: varchar

  # Function sources for document references
  functions:
    # Parcels with document references
    parcels_with_documents:
      schema: public
      function: parcels_with_documents

    # Streets with document references
    streets_with_documents:
      schema: public
      function: streets_with_documents

    # Addresses with document references
    addresses_with_documents:
      schema: public
      function: addresses_with_documents
